---
import Layout from "../layouts/Layout.astro";
import ActivityBar from "../components/ActivityBar.astro";

// Replace with your Formspree form endpoint (ex: https://formspree.io/f/xyzabc)
const FORM_ENDPOINT = "https://formspree.io/f/mldzlbbl";
---

<Layout title="Contact">
  <div class="fixed top-0 left-0 w-[70px] h-screen z-20">
    <ActivityBar />
  </div>

  <main class="min-h-screen max-w-sm lg:max-w-9/10 flex flex-col items-center justify-start pt-32 pb-20 pl-25 lg:px-6 lg:ml-20">
    <h1 class="font-bold text-2xl lg:text-5xl mt-30 mb-20 lg:m-40 text-center">On reste en contact ?</h1>

    <div class="w-full max-w-sm lg:max-w-5xl flex flex-col gap-24">
      <div>
        <h2 class="text-xl text-[#36C5F9] mb-10">Via mes réseaux</h2>
        <div class="flex flex-col lg:flex-row items-center justify-center gap-2 lg:gap-20 text-sm text-[#cfcfcf] w-full">
          <div class="w-full flex items-center lg:w-auto lg:block lg:items-center lg:justify-center">
            <a href="https://www.linkedin.com/in/ugo-lippi-5404a0337/" target="_blank" class="flex items-center gap-3">
              <img src="/Linkedin.svg" alt="LinkedIn" class="w-6 h-6 lg:w-12 lg:h-12" loading="lazy" decoding="async" />
              <span class="underline underline-offset-2 lg:text-2xl">Ugo LIPPI</span>
            </a>
          </div>

          <div class="block lg:hidden w-full h-px bg-gray-600 my-3" aria-hidden="true"></div>

          <div class="w-full flex items-center lg:w-auto lg:block lg:items-center lg:justify-center">
            <a href="https://github.com/Lippi-Ugo" target="_blank" class="flex items-center gap-3">
              <img src="/GitHub.svg" alt="GitHub" class="w-6 h-6 lg:w-12 lg:h-12" loading="lazy" decoding="async"/>
              <span class="underline underline-offset-2 lg:text-2xl">Lippi-Ugo</span>
            </a>
          </div>

          <div class="block lg:hidden w-full h-px bg-gray-600 my-3" aria-hidden="true"></div>

          <div class="w-full flex items-center lg:w-auto lg:block lg:items-center lg:justify-center">
            <a href="mailto:contact@ugo-lippi.fr" class="flex items-center gap-3">
              <svg class="w-6 h-6 text-orange-400" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5L12 13L21 8.5" stroke="#F59E0B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
              <span class="underline underline-offset-2 lg:text-2xl">contact@ugo-lippi.fr</span>
            </a>
          </div>
        </div>
      </div>

      <div class="flex flex-col items-center">
        <h2 class="text-xl text-[#36C5F9] mb-10 self-start">Via le formulaire</h2>

        <form id="contact-form" class="space-y-5 w-full max-w-[720px]" method="POST" action={FORM_ENDPOINT}>
          <div class="flex flex-col items-center gap-4">
            <input name="prenom" id="prenom" placeholder="Votre Nom" class="block w-full rounded-full py-3 px-4 bg-[#e6e6e6] text-sm placeholder-gray-600 text-black" required />
            <input name="nom" id="nom" placeholder="Votre Prénom" class="block w-full rounded-full py-3 px-4 bg-[#e6e6e6] text-sm placeholder-gray-600 text-black" required />
            <input name="email" id="email" type="email" placeholder="Votre Email" class="block w-full rounded-full py-3 px-4 bg-[#e6e6e6] text-sm placeholder-gray-600 text-black" required />
            <input name="objet" id="objet" placeholder="Objet" class="block w-full rounded-full py-3 px-4 bg-[#e6e6e6] text-sm placeholder-gray-600 text-black" />
            <textarea name="message" id="message" rows="5" placeholder="Votre Message" class="block w-full rounded-lg py-3 px-4 bg-[#e6e6e6] text-sm placeholder-gray-600 text-black" required></textarea>
          </div>

          <div class="mt-4 flex justify-center">
            <button id="submit-btn" type="submit" class="px-4 py-1 rounded-full border-3 border-[#4A4848] text-[#36C5F9]">Envoyer</button>
          </div>
          <div id="form-status" class="text-sm lg:text-lg text-neutral-50 text-center mt-3"></div>
        </form>
      </div>
    </div>

    <script type="module">
      const form = document.getElementById('contact-form');
      const status = document.getElementById('form-status');
      const btn = document.getElementById('submit-btn');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        status.textContent = '';
        btn.disabled = true;
        btn.textContent = 'Envoi...';

        try {
          const data = new FormData(form);
          const res = await fetch(form.action, {
            method: 'POST',
            body: data,
            headers: { 'Accept': 'application/json' }
          });

          if (res.ok) {
            status.textContent = 'Message envoyé — merci !';
            form.reset();
          } else {
            const json = await res.json();
            status.textContent = json?.error || 'Erreur lors de l\'envoi';
          }
        } catch (err) {
          status.textContent = 'Erreur réseau — réessayez plus tard.';
        } finally {
          btn.disabled = false;
          btn.textContent = 'Envoyer';
        }
      });
    </script>
  </main>
</Layout>
